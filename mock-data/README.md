# Generating Mock Data and Populating Our Database

`generate.py` is a simple python script that seeds our database with
somewhat realistic values. 

1.  [Running the Script](#running-the-script)
1.  [About This Script](#about-this-script)
    1.  [Random Value Generation](#random-value-generation)
    1.  [Changing The Amount of Generated Values](#changing-the-amount-of-generated-values)
    1.  [Clearing The Database](#clearing-the-database)
1.  [TODO](#todo)
1.  [Things to Think About](#things-to-think-about)

---

## Running the Script

[back to top](#generating-mock-data-and-populating-our-database)

Set the appropriate URL in `modules/config.py`

```py
# Production build
API_BASE_URL = "http://35.184.141.85:8080"

# Local testing
API_BASE_URL = "http://localhost:8080"
```

Load the python virtual environment, download dependencies, and run the script.

```bash
source venv/bin/activate
pip install -r requirements.txt
python3 generate.py
```

---

## About This Script

[back to top](#generating-mock-data-and-populating-our-database)

This script generates random values to seed our database with, sends requests
to the api layer to add these to the database, and saves generated json objects
to files for logging purposes.

### File Structure

```
generate.py
modules/
 |_ __init__.py
 |_ config.py
 |_ generators.py
 |_ models.py
 |_ utils.py
 |_ static.py
clear-db.py
```

`generate.py`

Main script.

`modules/config.py`

Contains generatal configuration data. `API_BASE_URL`, `city_state_map`,
`center_names_provider`, pet name providers, `species_classifications`,
and `species_breeds`. These are all constant values that are used to
generate random values later.

`modules/generators.py`

Contains the actual generation logic for owners, centers, pets, events, and preferences.

`modules/models.py`

Contains enums for Sex, AgeClass, and Size.

`modules/utils.py`

Contains utility functions for getting, posting, and printing json data.

`modules/static.py`

Contains static owner and center accounts for developer use.

### Random Value Generation

[back to top](#generating-mock-data-and-populating-our-database)

This script uses a combination of python's built in `random` module and
the `Faker` module. `Faker` provides many different randomly generated
values, such as names, addresses, emails, and passwords. If we want to
specify a distinct range of values for `Faker` to choose from, we can
implements our own `DynamicProvider` instances. See `center_names_provider`
for an example. If we want `Faker` to randomly generate distinct values,
we can use the `unique` keyword to ensure that Faker only creates distinct
values for this session.

### Changing The Amount of Generated Values

[back to top](#generating-mock-data-and-populating-our-database)

In `generate.py` we can see variables defined for the number of each
instance to generate.

```py
# NUMBER OF GENERATIONS
num_centers = len(center_names_provider.elements)
num_owners = 50
min_pets_per_center = 10
max_pets_per_center = 20
min_events_per_center = 5
max_events_per_center = 10
```

The number of centers looks in our `center_names_provider` to see the amount
of defined names. It will generate a center for each of these names. If we
want more centers, then we can define additional centers in the `elements`
section of `center_names_provider`. If we want fewer centers, then we can
simply define a constant value in place of `len(center_names_provider.elements)`.

For each adoption center created, the script generates a random amount of
pets and events between `min_pets_per_center` and `max_pets_per_center` or
between `min_events_per_center` and `max_events_per_center`, respectively.

### Clearing the Database

[back to top](#generating-mock-data-and-populating-our-database)

There is another python script, `clear-db.py`, that will clear all database
tables.

***Use this script with extreme caution on production builds***

---

## TODO

[back to top](#generating-mock-data-and-populating-our-database)

* [x] Add Faker calls to create realistic data.
    * [x] First name, last name
    * [x] Pet name?
        * Used DynamicProvider
    * [x] Parse the faker returned address into street addr, city, state
    * [x] Preload specific center names.
        * Used DynamicProvider
* [x] Add non-random dev accounts so we don't have to make a new account
    everytime after clearing db
* [ ] Randomly generate images
    * Unsplash API?
        * Limit of 50 requests per hour
    * Lorem Picsum?
    * Pillow?
    * OpenCV?

## Things to think about

[back to top](#generating-mock-data-and-populating-our-database)

* [x] What to do with ids? Should I insert data for centers, users, insert into
    database, then query for the id generated by the database in order to link
    images, preferences, pet posts, events?
    * I receive the `userid` for an account after creation. This is used
      when creating preferences, pets, and events
* [ ] SQLdump after generating data?
    * I should be able to just run the script while specifying the
      production build url instead of localhost
